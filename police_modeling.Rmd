---
title: "Modeling"
author: "Connie Wu"
date: "10/13/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Modeling
```{r}
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(lmtest)
```

```{r load-data}
final_df <- readRDS("data/final.rds")

single_victims <- final_df %>% 
  filter(NumberOfSubjects <= 1)

mult_victims <- final_df %>% 
  filter(NumberOfSubjects > 1)
```

```{r}
fit1 <- glm(formula = fatal ~ SubjectRace, family = binomial, data=single_victims)

fit2 <- glm(formula = fatal ~ SubjectRace + I(black/city_pop_2013), family = binomial, data=single_victims)
lrtest(fit2, fit1)
summary(fit2)

# Victim Gender doesn't appear to be significant
fit3 <- glm(formula = fatal ~ SubjectRace + I(black/city_pop_2013) + SubjectGender, family = binomial, data=single_victims)
lrtest(fit3, fit2)

fit4 <- glm(formula = fatal ~ SubjectRace + I(black/city_pop_2013) + ob, family = binomial, data=single_victims)
lrtest(fit3, fit4)

fit5 <- glm(formula = fatal ~ SubjectRace + I(black/city_pop_2013) + ob + ow, family = binomial, data=single_victims)
lrtest(fit5, fit4)

fit6 <- glm(formula = fatal ~ SubjectRace + I(black/city_pop_2013) + ob + ow + ol, family = binomial, data=single_victims)
lrtest(fit5, fit6)

fit7 <- glm(formula = fatal ~ SubjectRace + I(black/city_pop_2013) + ob + ow + ol + ow:SubjectRace, family = binomial, data=single_victims)
lrtest(fit6, fit7)

fit8 <- glm(formula = fatal ~ SubjectRace + I(black/city_pop_2013) + ob + ow + ol + ow:SubjectRace, family = binomial, data=single_victims)
lrtest(fit8, fit7)

fit9 <- glm(formula = fatal ~ SubjectRace + I(black/city_pop_2013) + ob + ow + ol + ow:SubjectRace + gun, family = binomial, data=single_victims)
lrtest(fit8, fit9)
summary(fit9)
```

```{r}
mult1 <- glm(formula = fatal ~ sb + sw + sl + I(black/city_pop_2013) + ob + ow + ol + ow:sb + gun, family = binomial, data=mult_victims)
summary(mult1)
```

